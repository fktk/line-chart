# line-chart

CSVを読み込み、ラインチャートを描画します。

## 概要

エクセルでたくさんの生データをグラフ化するのは結構大変ですよね。

いつの間にか生データは見ずに、マクロで処理された集約値ばかりを見るようになった(私のような)中堅技術者が、生データをちゃんと確認するようにとの思いを込めて作りました。

ドラッグアンドドロップですぐにグラフ化ができます。

Pythonなどでも人気のあるPlotlyを使っているため、インタラクティブでまるでデータに触っているかのような操作感が得られます。

一つのHTMLファイルにJavaScript、CSSを埋め込み、データを保持することで、可搬性の高いアプリに仕上げました。

Internet Explorer以外のモダンなブラウザならアプリを開くことができるため、専用ソフトのようなデータ共有の煩わしさがありません。上司にもそのまま渡せます。(エクセルで作り直せと言われるかもしれませんが)

[デモページ](http://tkhome.top/line/)

外部との通信はしていないため(オフラインで使用可)、セキュリティ面の心配はありません。

質問やバグ、カスタマイズの依頼などあれば、[こちら](https://docs.google.com/forms/d/e/1FAIpQLSfdhe5fPcYHjvfl1iz8y-G7ZS7P32vCShWe_7Aa3kwKlAGXOw/viewform?usp=sf_link)からお気軽にご連絡ください。

## アプリの取得方法

デモページの下部のチャートを保存ボタンを押すと、chart.htmlを取得できます。

または、Node.jsがインストールされているなら、このレポジトリをクローンして

```
npm install
npm run build:prod
```

でchart.htmlを作成できます。

## 使い方

### データ読み込み

ヘッダー行を含むCSVファイルで、データに文字列がない列のみを読み込みます。

* フォルダータブ中のファイル選択ボタンからCSVファイルを選択する
* CSVファイルを直接ウィンドウ内にドロップしてファイルを読み込ませる
* ページ下部のチャートを読み込むボタンを押すと、チャートを保存ボタンで保存したhtmlファイルからデータを読み込み追加することができる

### フォルダータブ中のファイルリストの操作

* リストをドラッグアンドドロップすることで凡例の順番を入れ替える
* チェックボックスで描画のオンオフを切り替える
* カラーピッカーで色を変える
* 鉛筆ボタンで凡例の名前を変更する
* xボタンでデータを消去する

### 軸の選択、操作

* チャートタブ中から、描画するx軸、y軸の組み合わせを選択する
* チャート上のツールバーでズーム、パンを切り替え軸の値を操作する
* チャートタブの中のmin、maxでも軸の範囲を操作できる

### 凡例の操作

* チャートタブ中の凡例スイッチで凡例のオンオフを切り替える
* 凡例の描画方向を垂直または水平に切り替えられる
* チャート中の凡例をドラッグすると凡例が移動する

### データの保存

* チャート中のツールバーにあるカメラボタンを押すと、現在のチャートが予め決まった大きさ(800x600px パワポなどへの貼付け用)で保存される
* ページ下部のチャートを保存を押すとその時のデータ、選択されている軸などが保存され、再度開くときにほぼ同じ状態で開ける(軸の範囲は保存していない)

